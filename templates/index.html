{% extends "base.html" %}

{% block content %}
<div class="app-container">
    <!-- Control Panel -->
    <div class="control-panel">
        <div class="panel-section">
            <h3 class="section-title">
                <i class="fas fa-cogs"></i>
                Algorithm Configuration
            </h3>
            
            <!-- Algorithm Selection -->
            <div class="control-group">
                <label class="control-label">Select Algorithm</label>
                <div class="algorithm-selector">
                    <input type="radio" id="kruskal" name="algorithm" value="kruskal" checked>
                    <label for="kruskal" class="algorithm-option">
                        <span class="algorithm-name">Kruskal's Algorithm</span>
                        <span class="algorithm-desc">Edge-based approach</span>
                    </label>
                    
                    <input type="radio" id="prim" name="algorithm" value="prim">
                    <label for="prim" class="algorithm-option">
                        <span class="algorithm-name">Prim's Algorithm</span>
                        <span class="algorithm-desc">Vertex-based approach</span>
                    </label>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="control-group">
                <button class="modern-btn primary calculate-btn" id="calculate-mst">
                    <i class="fas fa-play"></i>
                    <span>Execute MST Analysis</span>
                </button>
                
                <button class="modern-btn secondary reset-btn" id="resetBtn">
                    <i class="fas fa-refresh"></i>
                    <span>Reset System</span>
                </button>
            </div>
        </div>
        
        <!-- Animation Controls -->
        <div class="panel-section" id="animation-section" style="display: none;">
            <h3 class="section-title">
                <i class="fas fa-film"></i>
                Animation Controls
            </h3>
            
            <div class="animation-controls">
                <button class="control-btn step-back-btn" id="step-backward">
                    <i class="fas fa-step-backward"></i>
                </button>
                
                <button class="control-btn play-btn" id="play-pause">
                    <i class="fas fa-play" id="play-icon"></i>
                </button>
                
                <button class="control-btn step-forward-btn" id="step-forward">
                    <i class="fas fa-step-forward"></i>
                </button>
            </div>
            
            <div class="speed-controls">
                <button class="speed-btn" id="speed-slow">0.5x</button>
                <button class="speed-btn active" id="speed-normal">1x</button>
                <button class="speed-btn" id="speed-fast">2x</button>
            </div>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="content-area">
        <!-- Interactive Map -->
        <div class="modern-card map-container">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-map"></i>
                    Interactive Graph Visualization
                </h3>
                <div class="card-actions">
                    <span class="map-info">Drag nodes to reposition</span>
                </div>
            </div>
            <div class="card-content">
                <div id="hanoi-map" class="map-canvas"></div>
            </div>
        </div>
    </div>
    
    <!-- Status & Results Panel -->
    <div class="status-panel">
        <!-- Current Status -->
        <div class="modern-card status-card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-info-circle"></i>
                    System Status
                </h3>
            </div>
            <div class="card-content">
                <div class="status-info">
                    <p class="info-text">
                        The MST algorithm will analyze all nodes in the graph. 
                        Edge weights are calculated using real geographic coordinates.
                    </p>
                </div>
                
                <!-- Current Step Display -->
                <div id="current-step-display" class="step-display" style="display: none;">
                    <div class="step-indicator" id="current-step-info">
                        <!-- Current step info will be displayed here -->
                    </div>
                </div>
                
                <!-- Console Log -->
                <div id="console-section" class="console-container" style="display: none;">
                    <h4 class="console-title">
                        <i class="fas fa-terminal"></i>
                        Execution Log
                    </h4>
                    <div id="console-log" class="console-output">
                        <!-- Console output here -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Results Panel -->
        <div class="modern-card results-card" id="results-panel" style="display: none;">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-chart-line"></i>
                    Analysis Results
                </h3>
            </div>
            <div class="card-content">
                <div id="mst-result" class="results-content">
                    <!-- Results will be displayed here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Progress Indicator -->
<div class="progress-indicator" id="progress-indicator" style="display: none;">
    <div class="progress-bar" id="progress-bar"></div>
    <div class="progress-text" id="progress-text">Analyzing...</div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Update header stats when data is loaded
    function updateHeaderStats(nodes, edges, totalCost) {
        const nodeCount = document.getElementById('node-count');
        const edgeCount = document.getElementById('edge-count');
        const totalCostEl = document.getElementById('total-cost');
        
        if (nodeCount) nodeCount.textContent = nodes || '8';
        if (edgeCount) edgeCount.textContent = edges || '28';
        if (totalCostEl) totalCostEl.textContent = totalCost ? totalCost.toFixed(1) : '0.0';
    }
    
    // Show animation section when MST is calculated
    function showAnimationSection() {
        const animationSection = document.getElementById('animation-section');
        if (animationSection) {
            animationSection.style.display = 'block';
        }
    }
    
    // Show progress indicator
    function showProgress(text = 'Processing...') {
        const indicator = document.getElementById('progress-indicator');
        const progressText = document.getElementById('progress-text');
        if (indicator) indicator.style.display = 'block';
        if (progressText) progressText.textContent = text;
    }
    
    function hideProgress() {
        const indicator = document.getElementById('progress-indicator');
        if (indicator) indicator.style.display = 'none';
    }
    
    // Expose functions globally for use by other scripts
    window.updateHeaderStats = updateHeaderStats;
    window.showAnimationSection = showAnimationSection;
    window.showProgress = showProgress;
    window.hideProgress = hideProgress;
</script>
{% endblock %}